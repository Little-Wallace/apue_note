## 文件I/O


> 本章讨论的是不带缓冲的I/O，区别于第五章的标准I/O

* open原子操作
> 如果存在多个进程创建同一个文件，为了确保只有一个文件创建成功，open提供了O_CREAT和O_EXCL，同时设置这两个标志，当文件已存在时则会open失败。注意if access {  open file }这样的操作并不能保证并发创建文件的正确性。有可能多个进程都检测到文件不存在后，然后一同创建了文件。

* sync与fsync
> sync只是将文件修改的块缓冲区排入内核写队列，并不等待磁盘写入完成。而fsync则会等待磁盘操作结束才返回，通常用于数据库这样的应用程序

* write原子操作
> 多个进程打开同一个文件时，只要设置为O_APPEND标志，每次write操作时，内核会自动设置偏移量为文件末尾，保证多进程追加写入同一个文件的正确性。

### 标准I/O库

> 上文所说的文件IO仅仅是UNIX系统的IO系统调用函数，而标准I/O库则是所有主流操作系统约定实现的接口标准。在unix环境下，标准I/O库是由上文的系统I/O调用实现的。

* unixIO库的文件操作围绕文件描述符， 而标准IO库的文件操作围绕流(stream)





